<div class = "col-lg-12 col-md-12 col-sm-12 col-xs-12 panelLeft animate__animated animate__fadeInLeft">
  <div class = "panelsWithOutMinHeight">
    <div class = "titleCards">
      <span><i class = "fas fa-sitemap"></i></span> Bitácora
    </div>
    <div class = "row justify-content-center">
      <div class = "col-xl-2 col-lg-6 col-sm-12">
        <app-input-container
          [formGroup] = "searchLogForm"
          controlName = "telephone"
          maxL = "14"
          name = "Teléfono"
          type = "number"
        ></app-input-container>
      </div>
      <div class = 'col-xl-4 col-lg-6 col-sm-12'>
        <div class = 'mb-4 relative'>
          <app-input-container
            (change) = 'this.rerender()'
            [formGroup] = 'searchLogForm'
            [value] = "now | date: 'yyyy-MM-dd'"
            controlName = 'initDate'
            maxL = "{{now | date:'yyyy-MM-dd'}}"
            name = 'Inicio de Búsqueda'
            type = 'Date'
          ></app-input-container>
        </div>
      </div>
      <div class = 'col-xl-4 col-lg-6 col-sm-12'>
        <div class = 'mb-4 relative'>
          <app-input-container
            (change) = 'this.rerender()'
            [formGroup] = 'searchLogForm'
            [value] = "now | date: 'yyyy-MM-dd'"
            controlName = 'endDate'
            maxL = "{{now | date:'yyyy-MM-dd'}}"
            name = 'Fin de Búsqueda'
            type = 'Date'
          ></app-input-container>
        </div>
      </div>
    </div>
  </div>
</div>

<div class = "panels animate__animated animate__fadeInLeft">
  <div class = "titleCards">
    <span><em class = "fas fa-users"></em></span> Filtro de Bitácora
  </div>

  <table [dtOptions] = "dtOptions"
         [dtTrigger] = "dtTrigger"
         aria-label = "Log de incidencias"
         class = "table table-striped"
         datatable>
    <thead>
    <tr>
      <th scope = "col">Nombre</th>
      <th scope = "col">Teléfono</th>
      <th scope = "col">Mensaje</th>
      <th scope = "col">Modelo del Teléfono</th>
      <th scope = "col">Fecha</th>
      <th scope = "col">Nivel</th>
      <th scope = 'col'>Opciones</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor = 'let issue of issues'
        class = 'animate__animated animate__fadeIn'>
      <td>{{issue.name}}</td>
      <td>{{issue.phone_number}}</td>
      <td>{{issue.message}}</td>
      <td> {{issue.userDevice}}</td>
      <td> {{issue.created_at}}</td>
      <td style = 'position: relative'>
        <div style = 'display: inline-block'>{{issue.level}}</div>
        <div [ngClass] = "issue.level < 4 ? 'typeIssue lowstatus' : 'typeIssue highstatus'"></div>
      </td>
      <td>
        <button
          (click) = 'openContext(issue.context,contenido)'
          class = 'btn-secundary'
          title = 'Context'><em class = 'fas fa-eye'> Ver</em>
        </button>
      </td>
    </tr>
    </tbody>
  </table>


</div>

<ng-template #contenido
             let-modal>

  <div class = 'modal-header'>
    <h5 class = 'modal-title'>Log Capturado</h5>
    <button (click) = 'this.modal.close()'
            aria-label = 'Close'
            class = 'btn-close'
            type = 'button'></button>
  </div>
  <div class = 'modal-body'>
    <div class = 'list-group'>
      <textarea [value] = 'valContext'
                readonly
                rows = '5'></textarea>
    </div>
  </div>
  <hr>
  <div class = 'text-center'>
    <button
      (click) = 'this.modal.close()'
      class = 'btn btn-secondary'
      data-bs-dismiss = 'modal'
      type = 'button'>Cerrar
    </button>
  </div>

</ng-template>
